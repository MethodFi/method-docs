---
sidebar_label: Retrieve an entity's debts
---

import EntitiesMethodDataCreateIndividual from '../../../src/snippets/EntitiesMethodDataCreateIndividual';
import EntitiesCreateIndividualAuthSession from '../../../src/snippets/EntitiesCreateIndividualAuthSession';
import EntitiesUpdateIndividualAuthSession from '../../../src/snippets/EntitiesUpdateIndividualAuthSession';
import ConnectionsRetrieve from '../../../src/snippets/ConnectionsRetrieve';
import AccountsHolderMethodDataList from '../../../src/snippets/AccountsHolderMethodDataList';


# Retrieve an entity's debts

Entities are a representation of your application's end-users. Method allows you to
automatically retrieve and link all of their debts.

:::note
This feature is part of Method's data product, which is separate from Method's core
payments product. Contact team@methodfi.com for more information.
:::

### Steps
- [Create an individual entity](#1-create-an-individual-entity) using their name and phone.
- [Create an auth session](#2-create-an-auth-session) for the entity to start the identity verification process.
- [Complete the auth session](#3-complete-the-auth-session) by providing answers to the retrieve security questions.
- [Retrieve the created connection](#4-retrieve-the-created-connection) generated by the identity verification process
- [Retrieve the created liability accounts](#5-retrieve-the-created-liability-accounts) created from the connection.

---

### 1. Create an individual entity
First we'll create an individual entity with only their name and phone.
The goal of this request is to obtain the `data:retrieve` [capability](/guides/entities/capabilities#retrieve-data) in
the entity's `available_capabilities` property.

In most cases, name and phone should be sufficient for Method's KYC (Know Your Customer) process,
but some entities may have to provide additional information. You can provide more information
by [updating an entity](/api/core/entities/update).

<EntitiesMethodDataCreateIndividual />

#### Response
```json
{
  "id": "ent_au22b1fbFJbp8",
  "type": "individual",
  "individual": {
    "first_name": "Kevin",
    "last_name": "Doyle",
    "phone": "+15555555555",
    "dob": null,
    "email": null
  },
  "capabilities": [
    "payments:receive",
    "payments:send"
  ],
  "available_capabilities": [
    "data:retrieve"
  ],
  "pending_capabilities": [],
  ...
}
```

---

### 2. Create an auth session
Now that we have an entity with the `data:retrieve` capability in the `available_capabilities` property,
we can create an auth session. This request returns a list of security questions pertaining to the entity
that they must correctly answer.

<EntitiesCreateIndividualAuthSession />

#### Response
```json
{
  "questions": [
    {
      "id" : "qtn_ywWqCnXDGGmmg",
      "text" : "What is the monthly payment of your most recent auto loan or lease?",
      "answers" : [
        {
          "id" : "ans_qHLLEUBVpSpTK",
          "text" : "$601 - $700"
        },
        {
          "id" : "ans_74H68MJjqNhk8",
          "text" : "None of the Above"
        },
        ...
      ]
    },
    ...
  ]
}
```

---

### 3. Complete the auth session
To complete the auth session, provide the answers to the previously requested security questions.
This request may either return a list of additional security questions, or
a `cxn_id` which indicates that the verification was successful.

<EntitiesUpdateIndividualAuthSession />

#### Response (Verification Successful)
Once we receive a non-null `cxn_id`, we have successfully verified this entity's
identity and retrieved their debt accounts.

```json
{
  "questions": [],
  "cxn_id": "cxn_iENwAPKnNqA5j"
}
```

#### Response (Additional Verification Required)
In some cases, you may need to go through an additional set of security questions to fully verify.
Simply repeat the request with answers for the new set of security questions.

```json
{
  "questions": [
    {
      "id" : "qtn_7smgfLrU6M5tt",
      "text" : "Which of the following is a current or previous employer?",
      "answers" : [
        {
          "id" : "ans_ZExAcSeGjgEwS",
          "text" : "Men's Wearhouse"
        },
        {
          "id" : "ans_8MRLxgtQxEmYV",
          "text" : "Target"
        },
        ...
      ]
    },
    ...
  ],
  "cxn_id": null
}
```

---

### 4. Retrieve the created connection
Now that we've successfully completed the auth session flow, we can retrieve the created connection
with the `cxn_id` from the previous step.

ℹ️ See the [connection object](/api/core/connections/object) to learn more.

<ConnectionsRetrieve />

#### Response
```json
{
  "id": "cxn_iENwAPKnNqA5j",
  "entity_id": "ent_au22b1fbFJbp8",
  "accounts": [
    "acc_XaDZc8tE4YVeJ",
    "acc_k5NzziUDg7hTg",
    "acc_p3xR5ne3iAX6g",
    "acc_mDDi64jzWUgSx",
    "acc_EpcLnJSkSCnRM"
  ],
  "source": "method_data",
  "status": "success",
  "error": null,
  "created_at": "2022-02-16T18:02:21.866Z",
  "updated_at": "2022-02-20T22:50:45.391Z",
  "last_synced_at": "2022-02-20T22:50:45.391Z"
}
```

---

### 5. Retrieve the created liability accounts
Now we'll retrieve the accounts created from the entity's completed auth session.
The resulting accounts created from this flow have the following capabilities:

* `data:retrieve` capability indicating that it's enhanced and comprehensive liability data.
* `payments:receive` capability indicating that the account is fully setup to be used for payments.

<AccountsHolderMethodDataList />

#### Response

```json
[
  {
      "id": "acc_XaDZc8tE4YVeJ",
      "holder_id": "ent_au22b1fbFJbp8",
      "type": "liability",
      "ach": null,
      "liability": {
        "mch_id": "mch_21",
        "mask": "3092",
        "type": "credit_card",
        "credit_card": {
          "name": "Wells Fargo Credit Card",
          "balance": 57300,
          "last_payment_amount": 13900,
          "last_payment_date": "2022-03-21",
          "next_payment_due_date": "2022-04-21",
          "next_payment_minimum_amount": 4500,
          "opened_at": "2021-06-15"
        }
      },
      "clearing": null,
      "metadata": null,
      "status": "active",
      "capabilities": [
        "payments:receive",
        "data:retrieve"
      ],
      "error": null,
      "created_at": "2022-02-16T00:47:32.508Z",
      "updated_at": "2022-02-16T00:47:32.508Z"
    },
    {
      "id": "acc_k5NzziUDg7hTg",
      "holder_id": "ent_au22b1fbFJbp8",
      "type": "liability",
      "ach": null,
      "liability": {
        "mch_id": "mch_183",
        "mask": "6382",
        "type": "credit_card",
        "credit_card": {
          "name": "Chase Sapphire Reserve",
          "balance": 166500,
          "last_payment_amount": 63925,
          "last_payment_date": "2022-03-17",
          "next_payment_due_date": "2022-04-17",
          "next_payment_minimum_amount": 4600,
          "opened_at": "2019-03-11"
        }
      },
      "clearing": null,
      "metadata": null,
      "status": "active",
      "capabilities": [
        "payments:receive",
        "data:retrieve"
      ],
      "error": null,
      "created_at": "2022-02-16T02:56:19.548Z",
      "updated_at": "2022-02-16T02:56:19.548Z"
    },
  ...
]
```
